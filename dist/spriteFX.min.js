"use strict";!function(t){function i(){return document.createElement("canvas").getContext("2d")}var e=function(t){if(!(this instanceof e))return new e(t);this.ctx=i(),this.canvas=this.ctx.canvas,this.tempCtx=i(),this.tempCanvas=this.tempCtx.canvas,t&&this.newImage(t)};e.extend=function(t,i){this.prototype[t]=i},e.prototype={_clear:function(){this.ctx.clearRect(0,0,this.width,this.height)},_fill:function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.width,this.height)},_setOp:function(t,i){t.globalCompositeOperation=i},_copyImage:function(){this.tempCtx.drawImage(this.canvas,0,0)},_pasteImage:function(){this.ctx.drawImage(this.tempCanvas,0,0)},_setSize:function(t,i){this.width=this.canvas.width=this.tempCanvas.width=t,this.height=this.canvas.height=this.tempCanvas.height=i},_done:function(){return this._setOp(this.ctx,"source-over"),this.image=this.canvas,this},newImage:function(t){this.image=t,this._setSize(t.naturalWidth,t.naturalHeight),this.ctx.drawImage(t,0,0)},scale:function(t){var i=t.width||this.width*(t.height/this.height),e=t.height||this.height*(t.width/this.width);return this._copyImage(),this._clear(),this.canvas.width=i,this.canvas.height=e,this.ctx.drawImage(this.tempCanvas,0,0,this.tempCanvas.width,this.tempCanvas.height,0,0,i,e),this._setSize(i,e),this._done()},resize:function(t){return this.scale(t)},getImageObject:function(t,i){var e=new Image;e.onload=function(){t(e)},e.src=this.canvas.toDataURL(i?i:"image/png")},translate:function(t,i){return this._copyImage(),this._clear(),this.ctx.drawImage(this.tempCanvas,t,i),this._done()},crop:function(t,i,e,s){var n=this.width-t+e,h=this.height-i+s;return this._copyImage(),this._clear(),this.canvas.width=n,this.canvas.height=h,this.ctx.drawImage(this.tempCanvas,-t,-i),this._setSize(n,h),this._done()},fillFG:function(t){return this._setOp(this.ctx,"source-in"),this._fill(t),this._done()},fillBG:function(t){return this._setOp(this.ctx,"destination-over"),this._fill(t),this._done()},applyMask:function(t,i){return this._copyImage(),this.fillFG(t),this._setOp(this.ctx,i),this._pasteImage(),this._done()},alphamap:function(){return this.fillFG("#fff"),this.fillBG("#000"),this._done()},lighten:function(t){return this.applyMask("hsla(0, 0%, "+t+"%, 1)","screen")},darken:function(t){return this.applyMask("hsla(0, 0%, "+(100-t)+"%, 1)","multiply")},invert:function(){return this.applyMask("#fff","difference")},tint:function(t){return this.applyMask(t,"multiply")},multiply:function(t){return this.tint(t)},screen:function(t){return this.applyMask(t,"screen")},dropShadow:function(t,i,e){var s=this.ctx;return this._copyImage(),this._clear(),s.drawImage(this.tempCanvas,i,e),this.fillFG(t),this._setOp(s,"source-over"),this._pasteImage(),this._done()},custom:function(t){t.call(this)}},"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e:t.spriteFX=e}(window);