"use strict";!function(t){var i=function(){return document.createElement("canvas").getContext("2d")},s=function(t){return this instanceof s?(this.ctx=i(),this.canvas=this.ctx.canvas,this.tempCtx=i(),this.tempCanvas=this.tempCtx.canvas,void(t&&this.newImage(t))):new s(t)};s.extend=function(t,i){this.prototype[t]=i};var e=s.prototype;e._clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},e._fill=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.width,this.height)},e._setOp=function(t,i){t.globalCompositeOperation=i},e._copyImage=function(){this.tempCtx.drawImage(this.canvas,0,0)},e._pasteImage=function(){this.ctx.drawImage(this.tempCanvas,0,0)},e._setSize=function(t,i){this.width=this.canvas.width=this.tempCanvas.width=t,this.height=this.canvas.height=this.tempCanvas.height=i},e._done=function(){return this._setOp(this.ctx,"source-over"),this.image=this.canvas,this},e.newImage=function(t){this.image=t,this._setSize(t.naturalWidth,t.naturalHeight),this.ctx.drawImage(t,0,0)},e.scale=function(t){var i=t.width||this.width*(t.height/this.height),s=t.height||this.height*(t.width/this.width);return this._copyImage(),this._clear(),this.canvas.width=i,this.canvas.height=s,this.ctx.drawImage(this.tempCanvas,0,0,this.tempCanvas.width,this.tempCanvas.height,0,0,i,s),this._setSize(i,s),this._done()},e.resize=e.scale,e.translate=function(t,i){return this._copyImage(),this._clear(),this.ctx.drawImage(this.tempCanvas,t,i),this._done()},e.crop=function(t,i,s,e){var h=this.width-t+s,n=this.height-i+e;return this._copyImage(),this._clear(),this.canvas.width=h,this.canvas.height=n,this.ctx.drawImage(this.tempCanvas,-t,-i),this._setSize(h,n),this._done()},e.fillFG=function(t){return this._setOp(this.ctx,"source-in"),this._fill(t),this._done()},e.fillBG=function(t){return this._setOp(this.ctx,"destination-over"),this._fill(t),this._done()},e.applyMask=function(t,i){return this._copyImage(),this.fillFG(t),this._setOp(this.ctx,i),this._pasteImage(),this._done()},e.alphamap=function(){return this.fillFG("#fff"),this.fillBG("#000"),this._done()},e.lighten=function(t){return this.applyMask("hsla(0, 0%, "+t+"%, 1)","screen")},e.darken=function(t){return this.applyMask("hsla(0, 0%, "+(100-t)+"%, 1)","multiply")},e.invert=function(){return this.applyMask("#fff","difference")},e.tint=function(t){return this.applyMask(t,"multiply")},e.multiply=e.tint,e.screen=function(t){return this.applyMask(t,"screen")},e.dropShadow=function(t,i,s){var e=this.ctx;return this._copyImage(),this._clear(),e.drawImage(this.tempCanvas,i,s),this.fillFG(t),this._setOp(e,"source-over"),this._pasteImage(),this._done()},e.custom=function(t){t.call(this)},"function"==typeof define&&define.amd?define(s):"object"==typeof exports?module.exports=s:t.spriteFX=s}(window);