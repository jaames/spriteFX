"use strict";!function(t){var i=function(){return document.createElement("canvas").getContext("2d")},e=function(t){return this instanceof e?(this.ctx=i(),this.canvas=this.ctx.canvas,this.tempCtx=i(),this.tempCanvas=this.tempCtx.canvas,void(t&&this.newImage(t))):new e(t)};e.extend=function(t,i){this.prototype[t]=i};var s=e.prototype;s._clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},s._fill=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.width,this.height)},s._setOp=function(t,i){t.globalCompositeOperation=i},s._saveImage=function(){this.tempCtx.drawImage(this.canvas,0,0)},s._restoreImage=function(){this.ctx.drawImage(this.tempCanvas,0,0)},s._done=function(){return this._setOp(this.ctx,"source-over"),this.image=this.canvas,this},s.newImage=function(t){this.image=t,this.width=this.canvas.width=this.tempCanvas.width=t.naturalWidth,this.height=this.canvas.height=this.tempCanvas.height=t.naturalHeight,this.ctx.drawImage(t,0,0)},s.resize=function(t){var i=t.width||this.width*(t.height/this.height),e=t.height||this.height*(t.width/this.width);return this._saveImage(),this._clear(),this.canvas.width=i,this.canvas.height=e,this.ctx.drawImage(this.tempCanvas,0,0,this.tempCanvas.width,this.tempCanvas.height,0,0,i,e),this.width=this.tempCanvas.width=i,this.height=this.tempCanvas.height=e,this._done()},s.translate=function(t,i){return this._saveImage(),this._clear(),this.ctx.drawImage(this.tempCanvas,t,i),this._done()},s.fillFG=function(t){return this._setOp(this.ctx,"source-in"),this._fill(t),this._done()},s.fillBG=function(t){return this._setOp(this.ctx,"destination-over"),this._fill(t),this._done()},s.applyMask=function(t,i){return this._saveImage(),this.fillFG(t),this._setOp(this.ctx,i),this._restoreImage(),this._done()},s.alphamap=function(){return this.fillFG("#fff"),this.fillBG("#000"),this._done()},s.lighten=function(t){return this.applyMask("hsla(0, 0%, "+t+"%, 1)","screen")},s.darken=function(t){return this.applyMask("hsla(0, 0%, "+(100-t)+"%, 1)","multiply")},s.invert=function(){return this.applyMask("#fff","difference")},s.tint=function(t){return this.applyMask(t,"multiply")},s.multiply=s.tint,s.screen=function(t){return this.applyMask(t,"screen")},s.dropShadow=function(t,i,e){var s=this.ctx;return this._saveImage(),this._clear(),s.drawImage(this.tempCanvas,i,e),this.fillFG(t),this._setOp(s,"source-over"),this._restoreImage(),this._done()},s.custom=function(t){t.call(this)},"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e:t.spriteFX=e}(window);